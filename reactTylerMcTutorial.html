<!DOCTYPE html>
<html>
<head>
	<title>
		React Practice: Friends List
	</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.6/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.6/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.js"></script>

</head>
	<body>

		<div id="app">
		    <!-- This element's contents will be replaced with your component. -->
		</div>


<script type="text/babel">

var MainContainer = React.createClass({
    getInitialState: function(){
      return {
        name: 'JK_MNO',
        friends: [],
        text: ''
      }
    },
    handleChange: function(e){
    	this.setState({
    		text: e.target.value
    	});
    },
    handleSubmit: function(e){
      e.preventDefault();
      if(this.state.text !== '') {
        var nextfriend = this.state.friends.concat([{
          text: this.state.text, id: Date.now()
        }]);
        var nextText = '';
        this.setState({
          friends: nextfriend, text: nextText
        });
      }
    },
    handleDelete: function(e){
        var i = e.target.value;
        var friendsCopy = this.state.friends;
        this.setState(state => {
            friendsCopy.splice(i, 1);
            friends: friendsCopy
        });
    },
    render: function(){
      return (
        <div>
          <h3> Name: {this.state.name} </h3>
          <ShowList friends={this.state.friends} handleDelete={this.handleDelete} />
          <form onSubmit={this.handleSubmit} >
              Enter Friends: <input className="friendInput" onChange={this.handleChange} value={this.state.text} />
            </form> 
        </div>
      );
    }
});

var ShowList = React.createClass({
  render: function() {
    var createFriend = function(friend, index) {
       return (
        <li key={friend.id}>{friend.text} <button onClick={this.props.handleDelete} value={index}>Delete</button> </li>
      );
    };
    return <ul>{this.props.friends.map(createFriend.bind(this))}</ul>;
  }
});

ReactDOM.render(<MainContainer />, document.getElementById('app'));
</script>

	</body>
</html>
